<style>
mjx-container {
  font-size: 90% !important;
}
#mathjax-macros, .mathjax-macros {
  display: none !important;
}
</style>
<script>
MathJax = {
  loader: {load: ['[tex]/mathtools']},
  tex: {
    packages: {'[+]': ['mathtools']},
    inlineMath: [['$', '$'], ['\\(', '\\)']],
    displayMath: [['$$', '$$'], ['\\[', '\\]']],
    processEscapes: true,
    processEnvironments: true
  },
  options: {
    skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre']
  },
  startup: {
    pageReady: () => {
      // Process macros first (hidden), then typeset the rest
      const macroElements = [
        document.getElementById('mathjax-macros'),
        ...document.querySelectorAll('.mathjax-macros')
      ].filter(Boolean);
      
      if (macroElements.length > 0) {
        return MathJax.typesetPromise(macroElements).then(() => {
          return MathJax.typesetPromise();
        });
      }
      return MathJax.typesetPromise();
    }
  }
};
</script>
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js" async></script>

