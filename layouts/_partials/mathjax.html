<style>
/* Prevent MathJax from breaking mobile layout */
mjx-container {
  font-size: 90% !important;
  max-width: 100% !important;
  overflow-x: auto !important;
  overflow-y: visible !important;
}
mjx-container[display="true"] {
  display: block !important;
  padding: 0.5em 0;
}
/* Hide macros completely including any MathJax output */
#mathjax-macros, .mathjax-macros,
#mathjax-macros *, .mathjax-macros * {
  display: none !important;
  width: 0 !important;
  height: 0 !important;
  overflow: hidden !important;
}
/* Prevent layout breaking on mobile but compensate for link negative margins */
main {
  overflow-x: hidden;
  padding-left: 0.2em;
  margin-left: -0.2em;
}
</style>
<script>
MathJax = {
  loader: {load: ['[tex]/mathtools']},
  tex: {
    packages: {'[+]': ['mathtools']},
    inlineMath: [['$', '$'], ['\\(', '\\)']],
    displayMath: [['$$', '$$'], ['\\[', '\\]']],
    processEscapes: true,
    processEnvironments: true
  },
  options: {
    skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre']
  },
  startup: {
    pageReady: () => {
      // Process macros first (hidden), then typeset the rest
      const macroElements = [
        document.getElementById('mathjax-macros'),
        ...document.querySelectorAll('.mathjax-macros')
      ].filter(Boolean);
      
      if (macroElements.length > 0) {
        return MathJax.typesetPromise(macroElements).then(() => {
          return MathJax.typesetPromise();
        });
      }
      return MathJax.typesetPromise();
    }
  }
};
</script>
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js" async></script>

